---
title: "Day 2 Module 3"
author: "Lauren Pandori & John Paul Schmit"
date: "12/15/2021"
output: html_document
---
#### Intro to Data Wrangling  - Dplyr functions {.tabset}

<details open><summary class='drop'> Data Wrangling</summary>

In this section, we'll introduce functions in the dplyr package. This package is one of the packages that make up the tidyverse, so you won't have to install and call another package. The dplyr package is a group of functions that help to manipulate and summarize data. 
<https://www.rdocumentation.org/packages/dplyr/versions/0.7.8>

You can think of these functions like verbs that accomplish tasks, and are strung together by the pipe operator (%>% or |>).

We'll cover the following commands: 

  1. filter() - filters data for observations that meet specific criteria
  2. mutate() - adds new column(s) to a tibble
  3. select() - selects or removes columns
  4. rename() - renames columns
  5. arrange() - arranges a tibble by column values
  6. pull() + table() - JP I'm not sure how this would differ from select(single_col_name)
  7. group_by() %>% summarize() - summary calculations by groups/factor levels
  8. group_by() %>% mutate() - JP I don't use this combo too often

The data we'll use for modules 3-5 is from a program called Tidy Tuesday. Each week on Tuesday, the community posts data for exploratory data analysis and visualization. You can add data from this page to your RStudio environment by copying + pasting the "Get the data!" code chunk into your script and running it in the console.

<https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-09-17>

The data we'll use is in csv format, so we'll need to call the readr package, as well as the tidyverse and janitor for this lesson (if you've already called tidyverse and janitor, don't run those lines).

```{r echo=TRUE, message = FALSE, warning = FALSE}
library('readr')
library('janitor')
library('tidyverse')
```

Next, we'll load the data from the R for Data Science Tidy Tuesday GitHub page.There are three lines which will load three tibbles.

  1. park_visits - which contains data on visits to US National Parks
  2. state_pop - which contains information on populations of US states
  3. gas_price - which contains information on gas prices over space and time
  
For now, we'll focus on the park_visits tibble, and will circle back to the other two later. There are descriptions of each column for each tibble on the Tidy Tuesday website linked above if you'd like more information. 

```{r echo=TRUE, message = FALSE, warning = FALSE}
park_visits <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-09-17/national_parks.csv")
state_pop <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-09-17/state_pop.csv")
gas_price <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-09-17/gas_price.csv")
```

<details open><summary class='drop'> Working with Dplyr</summary>

Dplyr is a package that is part of the tidyverse, which is used with data.frames. It makes tasks like filtering and summarizing data easier. Many of the functions within the package are "verb-like" so they are easy to understand and remember. 

</details>
<br>
<details open><summary class='drop'> Dplyr- filter()</summary>

filter() - filters out rows from a data.frame based on values in columns
can combine criteria using & (and), | (or), ! (not)

If you'd like to get visitation data for just parks in the state of Washington (WA), you can use the filter command. The structure is as follows: 
```{r eval=FALSE, include=TRUE}
wa_park_visits <- filter(
                        # name of tibble
                        park_visits, 
                        # condition
                        state == 'WA'
                        )

# the command head() shows the first few rows of data
head(wa_park_visits)

# you can use the unique() command to check you've done the filtering correctly
unique(wa_park_visits$state)
```

For a more complicated example, you could 




1 simple example
1 example using more complicated criteria


</details>
<br>



<details open><summary class='drop'> dplyr - select() and rename()</summary>

select() - keeps the columns you indicate and drops the rest. you can rename the columns you select if you like, 
  can reorder columns as you go
rename() - keeps all the columns, but renames the ones you indicate

example of each
</details>
<br>



<details open><summary class='drop'> dplyr - arrange()</summary>
arrange()  reorders rows 

generally not needed in R, but can be helpful in exploring your data, and also 
when working with time series data and lagged values

example
</details>
<br>

<details open><summary class='drop'> dplyr - pull()</summary>

We may want to cut this to save time
pull() takes data from a column and returns in in vector form

pull() %>%  table() is a handy way to see a summary of categorical data (e.g. how may of each species is in your dataset)

example

</details>
<br>


<details open><summary class='drop'> dplyr - mutate()</summary>

mutate() makes new columns by doing calculations on old columns

examples
</details>
<br>


<details open><summary class='drop'> dplyr - group_by() and mutate()</summary>

group_by() indicates that data is in groups, so you can do calculations separately for each group

group_by() %>% mutate() will add a column and return the same number of rows that the original data had

example

</details>
<br>

<details open><summary class='drop'> dplyr - group_by() and summarize()</summary>

group_by() and  summarize() (or summarise()) also work with groupd data
Here you calculate a summary for each group. Output data frame will have the columns that
define the group and the summary data, will have one row for each group

examples
</details>
<br>